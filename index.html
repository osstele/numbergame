<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Dot-to-Dot Number Tracing (1â€“100)</title>
<style>
  :root{
    --bg:#0b1020; --panel:#12182b; --ink:#eaf1ff; --muted:#b9c5e6;
    --ghost:#8fa2d9; --next:#46e3a6; --hit:#ffd166; --trace:#99c2ff;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;background:radial-gradient(1200px 600px at 70% -10%,#1a2444 10%,#0b1126 60%,#060a17 100%);
       color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;
       display:flex;justify-content:center;align-items:stretch}
  .app{width:min(1100px,96vw);margin:18px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.09);
       border-radius:18px;box-shadow:0 18px 40px rgba(0,0,0,.35);display:grid;grid-template-rows:auto 1fr}
  header{display:flex;gap:12px;align-items:center;justify-content:space-between;padding:12px 14px;border-bottom:1px solid rgba(255,255,255,.08)}
  h1{margin:0;font-size:clamp(18px,2.6vw,28px)}
  .controls{display:flex;gap:8px;align-items:center}
  .btn{appearance:none;border:1px solid rgba(255,255,255,.25);background:#0f162e;color:var(--ink);
       padding:8px 12px;border-radius:10px;font-weight:600;cursor:pointer}
  .btn:hover{transform:translateY(-1px)}
  .stats{color:#cfe0ff}
  .wrap{display:grid;grid-template-columns:1fr 320px;gap:12px}
  @media (max-width:940px){ .wrap{grid-template-columns:1fr} }
  .stage{padding:12px}
  .panel{background:#071022;border:1px solid rgba(255,255,255,.08);border-radius:16px;position:relative;overflow:hidden}
  svg{width:100%;height:min(60vh,560px);display:block}
  .side{padding:12px;border-left:1px solid rgba(255,255,255,.08)}
  .grid{display:grid;grid-template-columns:repeat(5,1fr);gap:6px;max-height:58vh;overflow:auto}
  .nbtn{background:#121a36;color:#eaf1ff;border:1px solid rgba(255,255,255,.12);padding:10px;border-radius:10px;cursor:pointer}
  .nbtn:hover{background:#0f1630}
  .legend{display:flex;gap:14px;align-items:center;color:var(--muted);font-size:13px;padding:8px 2px}
  .dotKey,.nextKey,.hitKey{display:inline-flex;gap:6px;align-items:center}
  .k{width:14px;height:14px;border-radius:50%}
  .k.ghost{background:var(--ghost)}
  .k.next{background:var(--next)}
  .k.hit{background:var(--hit)}
  .status{padding:8px 2px;font-weight:700}
  .ok{color:#a4ffd2}
  /* confetti canvas overlays svg when celebrating */
  #confetti{position:absolute;inset:0;pointer-events:none}
</style>
</head>
<body>
  <div class="app">
    <header>
      <h1>Trace the Number â€” <span id="label">1</span></h1>
      <div class="controls">
        <span class="stats">Score: <b id="score">0</b> Â· Done: <b id="done">0</b>/100</span>
        <button class="btn" id="speakBtn">ðŸ”Š Speak</button>
        <button class="btn" id="easyBtn">Easy On</button>
        <button class="btn" id="nextBtn">Next â–¶</button>
        <button class="btn" id="resetBtn">â†º Reset</button>
      </div>
    </header>

    <div class="wrap">
      <div class="stage">
        <div class="panel">
          <svg id="board" viewBox="0 0 1000 560" aria-label="dot board"></svg>
          <canvas id="confetti"></canvas>
        </div>
        <div class="legend">
          <span class="dotKey"><span class="k ghost"></span> guide dots</span>
          <span class="nextKey"><span class="k next"></span> next dot</span>
          <span class="hitKey"><span class="k hit"></span> hit</span>
        </div>
        <div id="status" class="status">Tap the green dot, then the next, until the number is complete.</div>
      </div>

      <aside class="side">
        <div style="display:flex;justify-content:space-between;align-items:center;padding:0 2px 8px">
          <strong>Pick a number (1â€“100)</strong>
          <button class="btn" id="randomBtn">ðŸŽ² Random</button>
        </div>
        <div id="grid" class="grid"></div>
      </aside>
    </div>
  </div>

<script>
/* ==================== EASY DOT-TO-DOT ENGINE ==================== */
const svgNS = 'http://www.w3.org/2000/svg';
const board = document.getElementById('board');
const labelEl = document.getElementById('label');
const statusEl = document.getElementById('status');
const scoreEl  = document.getElementById('score');
const doneEl   = document.getElementById('done');
const speakBtn = document.getElementById('speakBtn');
const nextBtn  = document.getElementById('nextBtn');
const resetBtn = document.getElementById('resetBtn');
const randomBtn= document.getElementById('randomBtn');
const easyBtn  = document.getElementById('easyBtn');

let current = 1, score = 0, done = 0;
let dots = [];          // {cx,cy,el,hit}
let nextIdx = 0;
let easyMode = true;    // tap ANY nearby place to auto-advance

// Confetti
const confetti = document.getElementById('confetti');
const cctx = confetti.getContext('2d');
function sizeConfetti(){ confetti.width = board.clientWidth; confetti.height = board.clientHeight; }
addEventListener('resize', sizeConfetti); sizeConfetti();

function speak(n){
  const msg = new SpeechSynthesisUtterance(n.toString());
  msg.lang = 'en-US'; speechSynthesis.speak(msg);
}
speakBtn.addEventListener('click', ()=>speak(current));
nextBtn.addEventListener('click', ()=> setNumber(current>=100?1:current+1, true));
resetBtn.addEventListener('click', ()=> setNumber(current,false));
randomBtn.addEventListener('click', ()=> setNumber(1+Math.floor(Math.random()*100), true));
easyBtn.addEventListener('click', ()=>{
  easyMode = !easyMode;
  easyBtn.textContent = easyMode ? 'Easy On' : 'Easy Off';
});

/* ---- Seven segment layout â†’ dot generation ---- */
const DIGIT_W=240, DIGIT_H=420, GAP=40, R=14; // dot radius
const ORDER = { // recommended stroke order per digit
  0:['a','b','c','d','e','f'],
  1:['b','c'],
  2:['a','b','g','e','d'],
  3:['a','b','g','c','d'],
  4:['f','g','b','c'],
  5:['a','f','g','c','d'],
  6:['a','f','g','c','d','e'],
  7:['a','b','c'],
  8:['a','b','c','d','e','f','g'],
  9:['a','b','c','d','f','g'],
};
function segLines(x0,y0){ // center-lines for each segment inside a digit box
  const w=DIGIT_W,h=DIGIT_H, t=40;
  return {
    a:[ [x0+t, y0+t],[x0+w-t,y0+t] ],
    d:[ [x0+t, y0+h-t],[x0+w-t,y0+h-t] ],
    g:[ [x0+t, y0+h/2],[x0+w-t,y0+h/2] ],
    f:[ [x0+t, y0+t+10],[x0+t, y0+h/2-10] ],
    e:[ [x0+t, y0+h/2+10],[x0+t, y0+h-t-10] ],
    b:[ [x0+w-t, y0+t+10],[x0+w-t, y0+h/2-10] ],
    c:[ [x0+w-t, y0+h/2+10],[x0+w-t, y0+h-t-10] ],
  };
}
function lerp(a,b,t){ return a+(b-a)*t; }
function dotLine([x1,y1],[x2,y2],n){ // n evenly spaced dots
  const arr=[];
  for(let i=0;i<n;i++){
    const t=(i+1)/(n+1);
    arr.push([lerp(x1,x2,t), lerp(y1,y2,t)]);
  }
  return arr;
}
// dots per segment (more dots on long horizontals)
const DOTS_PER = {a:5,b:3,c:3,d:5,e:3,f:3,g:5};

function buildDotsForNumber(n){
  dots=[]; nextIdx=0; board.innerHTML='';
  const str = String(n);
  const totalW = str.length*DIGIT_W + (str.length-1)*GAP;
  const xStart = (1000-totalW)/2, yStart=(560-DIGIT_H)/2;

  for(let i=0;i<str.length;i++){
    const d = parseInt(str[i],10);
    const seg = segLines(xStart + i*(DIGIT_W+GAP), yStart);
    const order = ORDER[d];
    order.forEach(segName=>{
      const [p1,p2] = seg[segName];
      const pts = dotLine(p1,p2, DOTS_PER[segName]);
      pts.forEach(([cx,cy])=>{
        // guide dot
        const g = document.createElementNS(svgNS,'circle');
        g.setAttribute('cx',cx); g.setAttribute('cy',cy);
        g.setAttribute('r', R);  g.setAttribute('fill', 'var(--ghost)');
        g.setAttribute('opacity','.45');
        board.appendChild(g);

        // tappable dot (above guide)
        const c = document.createElementNS(svgNS,'circle');
        c.setAttribute('cx',cx); c.setAttribute('cy',cy);
        c.setAttribute('r', R*1.05);
        c.setAttribute('fill', 'var(--next)');
        c.dataset.idx = dots.length;
        c.style.cursor='pointer';
        c.addEventListener('pointerdown', onDotTap);
        board.appendChild(c);

        dots.push({cx,cy,el:c,hit:false});
      });
    });
  }
  updateNextHighlight();
}
function updateNextHighlight(){
  dots.forEach((d,i)=>{
    if (d.hit){ d.el.setAttribute('fill','var(--hit)'); d.el.setAttribute('opacity','.9'); }
    else if (i===nextIdx){ d.el.setAttribute('fill','var(--next)'); d.el.setAttribute('opacity','1'); }
    else { d.el.setAttribute('fill','transparent'); d.el.setAttribute('opacity','1'); }
  });
}

/* ---- Interaction ---- */
function onDotTap(e){
  const idx = +e.target.dataset.idx;
  if (idx===nextIdx || easyMode){          // easy = any dot advances
    dots[idx].hit = true;
    // auto-snap: mark any earlier un-hit dots as hit in easy mode
    if(easyMode && idx>nextIdx){
      for(let i=nextIdx;i<=idx;i++) dots[i].hit = true;
      nextIdx = idx+1;
    }else nextIdx++;

    updateNextHighlight();
    if (nextIdx>=dots.length){
      celebrate();
      score++; scoreEl.textContent=score;
      if (current>done) { done=current; doneEl.textContent=done; }
      status('Great job! Number complete.', 'ok');
      speak(current);
      // allow quickly going next
      setTimeout(()=>setNumber(current>=100?1:current+1,true), 900);
    }
  } else {
    // gentle nudge: briefly flash the correct dot
    dots[nextIdx].el.setAttribute('opacity','1');
  }
}

function status(text, cls){
  statusEl.textContent = text;
  statusEl.className = 'status' + (cls? ` ${cls}` : '');
}

function setNumber(n, announce){
  current=n;
  labelEl.textContent=n;
  buildDotsForNumber(n);
  status('Tap the green dot, then the next, until the number is complete.');
  if(announce) speak(n);
}

/* ---- Confetti celebration ---- */
function celebrate(){
  const pieces = 120;
  const P = [];
  sizeConfetti();
  for(let i=0;i<pieces;i++){
    P.push({
      x: Math.random()*confetti.width,
      y: -10,
      vx:(Math.random()-.5)*3,
      vy: 2+Math.random()*4,
      life: 80+Math.random()*80,
      clr:`hsl(${Math.random()*360},80%,60%)`
    });
  }
  function step(){
    cctx.clearRect(0,0,confetti.width,confetti.height);
    P.forEach(p=>{
      cctx.strokeStyle=p.clr; cctx.lineWidth=3;
      cctx.beginPath(); cctx.moveTo(p.x,p.y);
      cctx.lineTo(p.x+p.vx*4,p.y+p.vy*4); cctx.stroke();
      p.x+=p.vx; p.y+=p.vy; p.vy+=.03; p.life--;
    });
    if (P.some(p=>p.life>0)) requestAnimationFrame(step);
  }
  step();
}

/* ---- Build number grid ---- */
const grid = document.getElementById('grid');
for(let i=1;i<=100;i++){
  const b=document.createElement('button');
  b.className='nbtn'; b.textContent=i;
  b.addEventListener('click',()=>setNumber(i,true));
  grid.appendChild(b);
}

/* ---- Init ---- */
setNumber(1,false);
</script>
</body>
</html>
